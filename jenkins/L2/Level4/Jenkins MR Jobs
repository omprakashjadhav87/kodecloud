Click on the Jenkins button on the top bar to access the Jenkins UI. Login using username admin and password Adm!n321.


Similarly, click on the Gitea button on the top bar to access the Gitea UI. Login using username sarah and password Sarah_pass123.

There is a repository named sarah/mr_job in Gitea, which is cloned on the Storage server under /home/natasha/mr_job directory.


Update the index.html file under dev branch, and change its content from Welcome to Nautilus Group! to Welcome to xFusionCorp Industries!. Remember to push your changes to the origin repository.


After pushing the required changes, login to the Gitea server and you will find a pull request with title My First PR under mr_job repository. Merge this pull request.


Create/configure a Jenkins pipeline job named nginx-container, configure a pipeline as per details given below and run the pipeline on server App Server 2.


The pipeline must have two stages Build and Deploy (names are case sensitive).

In the Build stage, first clone the sarah/mr_job repository, then build an image named stregi01.stratos.xfusioncorp.com:5000/nginx:latest using the Dockerfile present under the root of the repository. 
stregi01.stratos.xfusioncorp.com:5000 is the image registry server. After building the image push the same to the image registry server.

In the Deploy stage, create a container named nginx-app using the image you built in the Build stage. Make sure to map container port to the host port 8080 and run the container in detached mode.

Make sure to build a successful job at least once so that you have at least one successful build # in the job history. Further, you can test the app using command curl http://stapp02:8080 from the jump host.

Solutions:- 

üõ†Ô∏è Step 1: Update index.html in the dev Branch
Login to Storage Server:

ssh natasha@<storage-server-ip>
cd /home/natasha/mr_job
git checkout dev

Edit the File:

sed -i 's/Welcome to Nautilus Group!/Welcome to xFusionCorp Industries!/' index.html

Commit & Push:
git add index.html
git commit -m "Updated welcome message in dev branch"
git push origin dev

üîÅ Step 2: Merge Pull Request in Gitea
Login to Gitea UI using:

Username: sarah

Password: Sarah_pass123

Navigate to sarah/mr_job ‚Üí Pull Requests ‚Üí Find "My First PR" ‚Üí Click Merge.

Created Credentials (Global)

Connect to your App
ssh steve@stapp02

sudo su -

yum install java-17-openjdk -y

Created Node, Relaunched the Node

As stapp02 to via ssh


üöÄ Step 3: Jenkins Pipeline Job Setup (nginx-container)
üîß Create Job

Login to Jenkins UI (admin / Adm!n321)

Create a Pipeline job named nginx-container

üìú Pipeline Script

pipeline {
    agent {
        label 'stapp02'
    }

    environment {
        IMAGE_NAME = 'stregi01.stratos.xfusioncorp.com:5000/nginx:latest'
        REPO_URL = 'http://git.stratos.xfusioncorp.com/sarah/mr_job.git'
        WORKDIR = 'mr_job'
    }

    stages {
        stage('Build') {
            steps {
                script {
                    // Clean workspace
                    sh "rm -rf ${WORKDIR}"

                    // Clone repository
                    sh "git clone ${REPO_URL}"

                    // Build Docker image
                    sh """
                        cd ${WORKDIR}
                        docker build -t ${IMAGE_NAME} .
                        docker tag ${IMAGE_NAME} ${IMAGE_NAME}
                        docker push ${IMAGE_NAME}
                    """
                }
            }
        }

        stage('Deploy') {
            steps {
                script {
                    // Run container
                    sh """
                        docker rm -f nginx-app || true
                        docker run -d --name nginx-app -p 8080:80 ${IMAGE_NAME}
                    """
                }
            }
        }
    }

    post {
        success {
            echo 'Pipeline executed successfully!'
        }
        failure {
            echo 'Pipeline failed. Check logs for details.'
        }
    }
}

take time to run 

Check container and image

[root@stapp02 nginx-container]# docker ps
CONTAINER ID   IMAGE                                                COMMAND                  CREATED          STATUS          PORTS                  NAMES
b2512bdfb942   stregi01.stratos.xfusioncorp.com:5000/nginx:latest   "/docker-entrypoint.‚Ä¶"   26 seconds ago   Up 24 seconds   0.0.0.0:8080->80/tcp   nginx-app
[root@stapp02 nginx-container]# docker images
REPOSITORY                                    TAG       IMAGE ID       CREATED          SIZE
stregi01.stratos.xfusioncorp.com:5000/nginx   latest    2f13ef1852a0   15 minutes ago   11.5MB


Curl http://stapp02:8080

thor@jumphost ~$ curl http://stapp02:8080
Welcome to xFusionCorp Industries!

If you have any issues and want to rerun the job, run this first: rm -rf mr_job

Also you can check mr_job, Dockerfile, index file

[root@stapp02 ~]# cd /home
[root@stapp02 home]# ls
ansible  steve
[root@stapp02 home]# cd steve/
[root@stapp02 steve]# ls
workspace
[root@stapp02 steve]# cd workspace/
[root@stapp02 workspace]# ls
nginx-container
[root@stapp02 workspace]# cd nginx-container/
[root@stapp02 nginx-container]# ls
caches  remoting  remoting.jar  workspace
[root@stapp02 nginx-container]# cd workspace/
[root@stapp02 workspace]# ls
nginx-container  nginx-container@tmp
[root@stapp02 workspace]# cd nginx-container
[root@stapp02 nginx-container]# ls
mr_job
[root@stapp02 nginx-container]# cd mr_job/
[root@stapp02 mr_job]# ls
Dockerfile  index.html
[root@stapp02 mr_job]# cat Dockerfile 
FROM nginx:stable-alpine3.17-slim
COPY index.html /usr/share/nginx/html/
[root@stapp02 mr_job]# cat index.html 
Welcome to xFusionCorp Industries!
[root@stapp02 mr_job]# 

