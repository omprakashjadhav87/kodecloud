The production support team of xFusionCorp Industries is working on developing some bash scripts to automate different day to day tasks. One is to create a bash script for taking websites

backup. They have a static website running on App Server 3 in Stratos Datacenter, and they need to create a bash script named blog_backup.sh which should accomplish the following tasks.

(Also remember to place the script under /scripts directory on App Server 3).

a. Create a zip archive named xfusioncorp_blog.zip of /var/www/html/blog directory.


b. Save the archive in /backup/ on App Server 3. This is a temporary storage, as backups from this location will be clean on weekly basis. Therefore, we also need to save this backup

archive

on Nautilus Backup Server.


c. Copy the created archive to Nautilus Backup Server server in /backup/ location.


d. Please make sure script won't ask for password while copying the archive file. Additionally, the respective server user (for example, tony in case of App Server 1) must be able to run it.

Ans:-

 I can help you with that! Here's a bash script named blog_backup.sh that accomplishes the tasks you mentioned:

vi  blog_backup.sh
=======================================================================================================================================================================================
#!/bin/bash

# Variables
SOURCE_DIR="/var/www/html/blog"
ARCHIVE_NAME="xfusioncorp_blog.zip"
BACKUP_DIR="/backup"
REMOTE_USER="backup_user"  # Replace with the actual user on Nautilus Backup Server
REMOTE_SERVER="nautilus_backup_server"  # Replace with the actual Nautilus Backup Server hostname or IP
REMOTE_DIR="/backup"

# Create a zip archive of the blog directory
zip -r ${BACKUP_DIR}/${ARCHIVE_NAME} ${SOURCE_DIR}

# Copy the archive to Nautilus Backup Server
scp -o StrictHostKeyChecking=no ${BACKUP_DIR}/${ARCHIVE_NAME} ${REMOTE_USER}@${REMOTE_SERVER}:${REMOTE_DIR}

# Ensure the script won't ask for password while copying the archive file
# This requires setting up SSH key-based authentication between App Server 3 and Nautilus Backup Server

# Place the script under /scripts directory
mv blog_backup.sh /scripts/

# Make the script executable
chmod +x /scripts/blog_backup.sh
=======================================================================================================================================================================================
This script will create a zip archive of the /var/www/html/blog directory, save it in the /backup directory on App Server 3, and then copy it to the /backup directory on Nautilus Backup

Server without asking for a password.

Steps to set up SSH key-based authentication:
Generate SSH key pair on App Server 3:

ssh-keygen -t rsa


Copy the public key to Nautilus Backup Server:

ssh-copy-id clint@172.16.238.16

This command will copy the public key from App Server 3 to the clint user's authorized keys on the Nautilus Backup Server at IP address 172.16.238.16. This ensures that clint can 

log in without a password.

ensure the script has executable permissions. You can set this with:
chmod +x /scripts/blog_backup.sh

Make sure you are in the directory where blog_backup.sh is located

./blog_backup.sh
